function del_nonexistent_dirs {
    local result
    for p in ${1//:/ }; do
        if [[ -d $p ]]; then
            # if result is set, prepend result and colon
            result="${result:+$result:}$p"
        fi
    done
    echo $result
}

export -f del_nonexistent_dirs

if [[ `uname -m` == x86_64 ]]; then
  MBITS=64
else
  MBITS=32
fi

export PATH=\
~/bin\
:$CONF-$SITE/host/$HOST/plat/$PLAT/bin\
:$CONF-$SITE/host/$HOST/bin\
:$CONF-$SITE/plat/$PLAT/bin\
:$CONF-$SITE/bin\
:$CONF/plat/$PLAT/bin\
:$CONF/common/bin\
:/usr/local/bin\
:/usr/local/sbin\
:/usr/kerberos/bin\
:/usr/bin\
:/usr/sbin\
:/bin\
:/sbin

export PATH=`del_nonexistent_dirs $PATH`
export BASH_ENV=~/.bashrc

# Locally installed software
if [[ -n $SW ]]; then
    STD=$SW/std
    export PATH=$STD/bin:$PATH
    export CPATH=$STD/include
    export LIBRARY_PATH=$STD/lib
    export LD_LIBRARY_PATH=$STD/lib
    export PKG_CONFIG_PATH=$STD/lib/pkgconfig:/usr/lib/pkgconfig
    export BONOBO_ACTIVATION_PATH=$STD/lib/bonobo/servers
    export PYTHONPATH=$STD/lib/python
    export PERLLIB=$STD/lib/perl5

    if [[ -d $STD/lib$MBITS ]]; then
        export LIBRARY_PATH=$STD/lib$MBITS:$LIBRARY_PATH
        export LD_LIBRARY_PATH=$STD/lib$MBITS:$LD_LIBRARY_PATH
    fi

    # # Java
    # export CLASSPATH=
    # for i in $STD/lib/java/*.jar; do
    #     export CLASSPATH=$CLASSPATH:$i
    # done

    # # # Tcl (for snack sound processing toolkit)
    # # export TCLLIBPATH=$STD/lib/snack2.2
fi

if [[ -z $LANG ]]; then
    export LANG="en_US.UTF-8"
fi

if [[ -d $HOME/perl5 ]]; then
    export PERL_LOCAL_LIB_ROOT="$HOME/perl5";
    export PERL_MB_OPT="--install_base $HOME/perl5";
    export PERL_MM_OPT="INSTALL_BASE=$HOME/perl5";
    export PERL5LIB="$HOME/perl5/lib/perl5/x86_64-linux-thread-multi:$HOME/perl5/lib/perl5";
    export PATH="$HOME/perl5/bin:$PATH";
fi

export PYTHONSTARTUP=$HOME/.pythonstartup
export EDITOR=vim

export PAGER='less'

#causes control sequences to appear on screen in OS X - not sure why
#export LESS='-M'       # make less give a better prompting

export PS1="\h(\!)[\w]\\\$ "
export PROMPT_COMMAND="history -a"
export HISTCONTROL=ignorespace
export HISTSIZE=2000
export HISTFILESIZE=5000
